# Container System 성능 벤치마크

**언어:** [English](BENCHMARKS.md) | **한국어**

**최종 업데이트**: 2025-11-28
**플랫폼**: Apple M1 (8코어, ARM NEON), macOS, Apple Clang 17.0
**빌드**: Release 모드, `-O3` 최적화

---

## 개요

이 문서는 Container System에 대한 포괄적인 성능 벤치마크를 제공합니다.

---

## 빠른 참조

### 핵심 성능 메트릭 (Apple M1, Release 빌드)

| 연산 | 처리량 | 지연시간 | 비고 |
|------|--------|---------|------|
| **컨테이너 생성** | 2M 컨테이너/s | 500 ns | 헤더 포함 빈 컨테이너 |
| **값 추가** | 4.5M ops/s | 222 ns | SIMD 활용 숫자 값 |
| **Binary 직렬화** | 1.8M ops/s | 556 ns | 1KB 컨테이너 |
| **JSON 직렬화** | 950K ops/s | 1.05 μs | 1KB 컨테이너 |
| **XML 직렬화** | 720K ops/s | 1.39 μs | 1KB 컨테이너, 스키마 |
| **역직렬화** | 2.1M ops/s | 476 ns | Binary 형식 |
| **SIMD 연산** | 25M ops/s | 40 ns | 숫자 배열 처리 |
| **이동 연산** | 4.2M ops/s | 238 ns | 제로 카피 값 이동 |

### 메모리 기준

- **빈 컨테이너**: 1.5 MB (할당자 오버헤드 포함)
- **문자열 값**: ~64 바이트 + 문자열 길이
- **숫자 값**: ~48 바이트
- **직렬화 오버헤드**: Binary ~10%, JSON ~40%

---

## 핵심 연산 벤치마크

### 컨테이너 생성 성능

| 컨테이너 크기 | 처리량 (컨테이너/s) | 지연시간 (ns) | 메모리 (MB) |
|---------------|---------------------|---------------|-------------|
| 빈 상태 | 2,000,000 | 500 | 1.5 |
| 10 값 | 1,500,000 | 667 | 2.1 |
| 100 값 | 500,000 | 2,000 | 8.5 |
| 1000 값 | 50,000 | 20,000 | 72.0 |

### 값 연산 성능

#### 기본 값 추가

| 값 타입 | 처리량 (ops/s) | 지연시간 (ns) |
|---------|----------------|---------------|
| `null_value` | 5,000,000 | 200 |
| `bool_value` | 4,800,000 | 208 |
| `int32_value` | 4,500,000 | 222 |
| `int64_value` | 4,400,000 | 227 |
| `float_value` | 4,300,000 | 233 |
| `double_value` | 4,200,000 | 238 |

#### 복합 값 추가

| 값 타입 | 처리량 (ops/s) | 지연시간 (ns) |
|---------|----------------|---------------|
| `string_value` (짧음) | 2,800,000 | 357 |
| `string_value` (긴) | 1,200,000 | 833 |
| `bytes_value` (작음) | 2,500,000 | 400 |
| `bytes_value` (큼) | 800,000 | 1,250 |
| `container_value` | 1,000,000 | 1,000 |

### 직렬화 성능

#### Binary 직렬화

| 컨테이너 크기 | 처리량 (ops/s) | 지연시간 (μs) | 크기 (바이트) | 오버헤드 |
|---------------|----------------|---------------|---------------|----------|
| 10 값 | 3,500,000 | 0.29 | 256 | ~10% |
| 100 값 | 2,000,000 | 0.50 | 2,048 | ~8% |
| 1000 값 | 450,000 | 2.22 | 18,432 | ~12% |

#### JSON 직렬화

| 컨테이너 크기 | 처리량 (ops/s) | 지연시간 (μs) | 크기 (바이트) | 오버헤드 |
|---------------|----------------|---------------|---------------|----------|
| 10 값 | 1,800,000 | 0.56 | 512 | ~40% |
| 100 값 | 950,000 | 1.05 | 4,096 | ~45% |
| 1000 값 | 200,000 | 5.00 | 36,864 | ~50% |

---

## 업계 표준 비교

### vs MessagePack

| 메트릭 | Container System | MessagePack | 차이 |
|--------|------------------|-------------|------|
| **직렬화** | 1.8M ops/s | 1.6M ops/s | +12.5% |
| **역직렬화** | 2.1M ops/s | 1.9M ops/s | +10.5% |
| **크기 오버헤드** | ~10% | ~8% | -2% |
| **타입 안전성** | 컴파일타임 + 런타임 | 런타임만 | ✓ 우수 |
| **SIMD 지원** | ARM NEON, AVX2 | 제한적 | ✓ 우수 |

### vs Protocol Buffers

| 메트릭 | Container System | Protocol Buffers | 차이 |
|--------|------------------|------------------|------|
| **직렬화** | 1.8M ops/s | 1.4M ops/s | +28.6% |
| **역직렬화** | 2.1M ops/s | 1.6M ops/s | +31.3% |
| **스키마 필요** | 아니오 | 예 | ✓ 우수 |
| **코드 생성** | 아니오 | 예 | ✓ 우수 |

### vs FlatBuffers

| 메트릭 | Container System | FlatBuffers | 차이 |
|--------|------------------|-------------|------|
| **직렬화** | 1.8M ops/s | 2.5M ops/s | FlatBuffers +38.9% |
| **역직렬화** | 2.1M ops/s | 5.0M ops/s | FlatBuffers +138.1% |
| **스키마 필요** | 아니오 | 예 | ✓ Container 우수 |
| **수정 용이성** | 쉬움 | 어려움 | ✓ Container 우수 |

---

## SIMD 가속 벤치마크

### ARM NEON 성능 (Apple M1)

| 연산 | 스칼라 (ops/s) | NEON (ops/s) | 속도 향상 | 처리량 |
|------|----------------|--------------|-----------|--------|
| `double` 배열 처리 | 7.8M | 25M | 3.2x | 3.8 GB/s |
| `float` 배열 처리 | 9.2M | 28M | 3.0x | 4.2 GB/s |
| `int64_t` 배열 처리 | 8.5M | 26M | 3.1x | 3.9 GB/s |
| `int32_t` 배열 처리 | 10M | 30M | 3.0x | 4.5 GB/s |

### x86 AVX2 성능 (Intel i7-12700K)

| 연산 | 스칼라 (ops/s) | AVX2 (ops/s) | 속도 향상 |
|------|----------------|--------------|-----------|
| `double` 배열 처리 | 6.5M | 16M | 2.5x |
| `float` 배열 처리 | 7.8M | 19M | 2.4x |

---

## 스레드 안전성 성능

### 동시 읽기 연산

| 연산 | 1 스레드 | 4 스레드 | 8 스레드 | 확장성 |
|------|----------|----------|----------|--------|
| `get_value()` | 8.0M/s | 31.2M/s | 60.0M/s | 7.5x |
| `serialize()` | 1.8M/s | 6.8M/s | 12.0M/s | 6.7x |

### 스레드 안전 컨테이너 성능

| 연산 | 표준 | thread_safe_container | 오버헤드 |
|------|------|----------------------|----------|
| 읽기 (단일 스레드) | 8.0M/s | 7.2M/s | -10% |
| 쓰기 (단일 스레드) | 4.5M/s | 3.8M/s | -15.6% |
| 쓰기 (4 스레드) | 2.0M/s | 3.2M/s | +60% |

---

## 메모리 풀 성능

| 블록 크기 | 표준 할당자 | 메모리 풀 | 속도 향상 |
|-----------|-------------|-----------|-----------|
| 16 바이트 | 80 ns | 8 ns | 10x |
| 64 바이트 | 95 ns | 5 ns | 19x |
| 256 바이트 | 120 ns | 6 ns | 20x |
| 1024 바이트 | 200 ns | 35 ns | 5.7x |

---

## 성능 최적화 권장사항

1. **컨테이너 사전 할당**: 알려진 크기에 `reserve_values()` 사용
   - **영향**: 15-25% 빠른 삽입

2. **Binary 직렬화 사용**: 성능 중요 경로에
   - **영향**: JSON보다 2배, XML보다 2.5배 빠름

3. **SIMD 활용**: 숫자 배열 처리에
   - **영향**: 지원 플랫폼에서 2.5-3.2배 속도 향상

4. **배치 연산**: 여러 값을 한 번에 설정
   - **영향**: 개별 추가보다 20-30% 빠름

5. **이동 시맨틱 사용**: 큰 문자열/데이터에
   - **영향**: 제로 카피, 4.2M ops/s

6. **깊은 중첩 피하기**: 데이터 구조 평탄화
   - **영향**: 직렬화 최대 10배 빠름

---

## 크로스 플랫폼 비교

| 플랫폼 | 아키텍처 | 컴파일러 | Binary 직렬화 | JSON 직렬화 | SIMD 속도 향상 |
|--------|----------|----------|---------------|-------------|----------------|
| **Apple M1** | ARM64 | Clang 17 | 1.8M/s | 950K/s | 3.2x (NEON) |
| **Intel i7-12700K** | x64 | GCC 13 | 1.6M/s | 850K/s | 2.5x (AVX2) |
| **AMD Ryzen 9** | x64 | GCC 13 | 1.55M/s | 820K/s | 2.3x (AVX2) |
| **Windows (MSVC)** | x64 | MSVC 2022 | 1.4M/s | 780K/s | 2.2x (AVX2) |

---

**최종 업데이트**: 2025-11-28
**버전**: 0.1.0

---

Made with ❤️ by 🍀☀🌕🌥 🌊
